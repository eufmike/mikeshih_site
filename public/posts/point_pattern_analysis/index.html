<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="As super-resolution microscopies get popular, we are seeing increasing researchers use them to resolve the spatial distribution of organelles. One good example is Airyscan. The resolution of Airyscan is slightly lower than SIM, yet, its success rate and stability make it the best bet when it comes to imaging organelle markers (MitoTracker or LysoTracker).
Once image acquisition and labeling are made, to conclude, a certain level of spatial analysis could be necessary." />
<meta name="keywords" content="homepage, blog" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="/posts/point_pattern_analysis/" />


    <title>
        
            Point Pattern Analysis :: Mike C.C. Shih 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.84ed5579024525d4b50458514d1a43e40dd5272df45c7cd6da85b225af457154.css">




    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="">

<meta itemprop="name" content="Point Pattern Analysis">
<meta itemprop="description" content="As super-resolution microscopies get popular, we are seeing increasing researchers use them to resolve the spatial distribution of organelles. One good example is Airyscan. The resolution of Airyscan is slightly lower than SIM, yet, its success rate and stability make it the best bet when it comes to imaging organelle markers (MitoTracker or LysoTracker).
Once image acquisition and labeling are made, to conclude, a certain level of spatial analysis could be necessary.">
<meta itemprop="datePublished" content="2019-04-20T14:44:08-05:00" />
<meta itemprop="dateModified" content="2019-04-20T14:44:08-05:00" />
<meta itemprop="wordCount" content="861">
<meta itemprop="image" content="/"/>



<meta itemprop="keywords" content="" /><meta property="og:title" content="Point Pattern Analysis" />
<meta property="og:description" content="As super-resolution microscopies get popular, we are seeing increasing researchers use them to resolve the spatial distribution of organelles. One good example is Airyscan. The resolution of Airyscan is slightly lower than SIM, yet, its success rate and stability make it the best bet when it comes to imaging organelle markers (MitoTracker or LysoTracker).
Once image acquisition and labeling are made, to conclude, a certain level of spatial analysis could be necessary." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/point_pattern_analysis/" />
<meta property="og:image" content="/"/>
<meta property="article:published_time" content="2019-04-20T14:44:08-05:00" />
<meta property="article:modified_time" content="2019-04-20T14:44:08-05:00" /><meta property="og:site_name" content="Mike C.C. Shih" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="Point Pattern Analysis"/>
<meta name="twitter:description" content="As super-resolution microscopies get popular, we are seeing increasing researchers use them to resolve the spatial distribution of organelles. One good example is Airyscan. The resolution of Airyscan is slightly lower than SIM, yet, its success rate and stability make it the best bet when it comes to imaging organelle markers (MitoTracker or LysoTracker).
Once image acquisition and labeling are made, to conclude, a certain level of spatial analysis could be necessary."/>





    <meta property="article:published_time" content="2019-04-20 14:44:08 -0500 CDT" />









<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">Mike C.C. Shih</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner">
        
        <li><a href="/about/">About</a></li><li><a href="/posts">Posts</a></li><li><a href="/projects/">Projects</a></li><li><a href="/publications/">Publications</a></li>
        
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>5 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="/posts/point_pattern_analysis/">Point Pattern Analysis</a>
            </h1>
                <hr />
                <aside id="toc">
                <div class="toc-title">Table of Contents</div>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#ripleys-k-function">Ripley’s K function</a></li>
    <li><a href="#examples">Examples</a>
      <ul>
        <li><a href="#canopy-reflectance-of-ponderosa-pine-tree">Canopy Reflectance of Ponderosa Pine Tree</a></li>
        <li><a href="#nanocluster-of-membrane-proteins">Nanocluster of Membrane Proteins</a></li>
      </ul>
    </li>
    <li><a href="#implementation">Implementation</a></li>
    <li><a href="#reference">Reference</a></li>
    <li><a href="#book--other-resource">Book &amp; Other Resource</a></li>
  </ul>
</nav>
                </aside>
                <hr />

            

            <div class="post-content">
                <p>As super-resolution microscopies get popular, we are seeing increasing researchers use them to resolve the spatial distribution of organelles. One good example is Airyscan. The resolution of Airyscan is slightly lower than SIM, yet, its success rate and stability make it the best bet when it comes to imaging organelle markers (<a href="https://www.thermofisher.com/order/catalog/product/M7514#/M7514">MitoTracker</a> or <a href="%5Blysotracker%5D(https://www.thermofisher.com/order/catalog/product/L7526?SID=srch-srp-L7526#/L7526?SID=srch-srp-L7526)">LysoTracker</a>).</p>
<p>Once image acquisition and labeling are made, to conclude, a certain level of spatial analysis could be necessary. The nearest distance from label A to B is a common choice; it fails to identify clusters since the lack of distance-density relationship. <strong>Ripley’s K function</strong> can come in handy in this type of study. The measure describes the distance-density relationship and is normalized by theoretical Poisson distribution. It is a standard geostatistical tool, widely seen in ecology and geography.</p>
<p>In fact, Ripley’s K function should not be a stranger to biologists. It was originally developed for Dr. Francis Crick’s challenge of measuring cell clustering. It and its derivatives are widely used in analyzing data collected from Single-Molecule localization Microscopies (SMLM), such as <a href="https://en.wikipedia.org/wiki/Photoactivated_localization_microscopy">stochastic optical reconstruction microscopy (STORM) and photoactivated localization microscopy (PALM)</a>.</p>
<h2 id="ripleys-k-function">Ripley’s K function</h2>
<p>I highly recommend reading the paper <a href="https://lib.dr.iastate.edu/stat_las_preprints/52/">&ldquo;Ripley’s K function&rdquo; by Philip M. Dixon</a>. The detail and application are well described, and here is the summary.</p>
<p>First, let&rsquo;s take a look at Ripley’s K function:</p>
<p>$$
\hat{K}(t)= \hat{\lambda}^{-1}\sum_{i}\sum_{j\neq1}\frac{\omega(l_i, l_j)I(d_{ij&lt;t})}{N}
$$</p>
<ul>
<li>$t$ is the given distance (or called radius)</li>
<li>$d_{ij&lt;t}$ is the distance between the $i$’th and $j$’th points</li>
<li>$I(x)$ is the indicator function: return $1$ when being inside the circle and $0$ when being outside</li>
<li>Edge correction is controlled by $\omega$</li>
<li>$\hat{\lambda}$ is the average density. It can be estimated by $N$/$A$, where $N$ is the observed number of points and $A$ is the area of the study region.</li>
</ul>
<p>A good use of Ripley’s K function is to compare with complete spatial randomness (CSR), in this case, homogeneous Poisson point process. As a result, $K(t)$ grows exponentially as $t$ increases under CSR. Therefore, $L(t)$ is proposed for an easier estimator to bring the function linear:</p>
<p>$$
\hat{L}(t)= (\frac{\hat{K}(t)}{\pi})^\frac{1}{2}
$$</p>
<p>Under CSR, $L(t) = t$. If we take one step further to test $L(t) − t = 0$ at each distance, the new function is also called $H(t)$ in some literature.</p>
<p>$$
\hat{H}(t)= \hat{L}(t) - t
$$</p>
<h2 id="examples">Examples</h2>
<h3 id="canopy-reflectance-of-ponderosa-pine-tree">Canopy Reflectance of Ponderosa Pine Tree</h3>
<p>Getis &amp; Franklin published a <a href="https://www.researchgate.net/publication/225885104_Second-Order_Neighborhood_Analysis_of_Mapped_Point_Patterns">paper</a> in 1987 using this method to study canopy reflectance for a ponderosa pine forest in Klamath National Forest in North California. 108 ponderosa pine tree was measured in an area of 120 m x 120 m. They used $\hat{L}(t)$ for measuring the effect of canopy and created this plot.</p>
<figure>
    <img src="/posts/point_pattern_analysis/img_01.png" width="450"/> 
</figure>

<p>We can see that in plot a, $L(t)$ is above the line with its slope equals to 1, which representing the $L(t)$ of CSR. It implied the cluster was formed. While in plot c, the effect is opposite.</p>
<p>The $L(t)$ can also be plotted with isoline with a given distance ($t$):
<figure>
    <img src="/posts/point_pattern_analysis/img_02.png" width="450"/> 
</figure>
</p>
<h3 id="nanocluster-of-membrane-proteins">Nanocluster of Membrane Proteins</h3>
<p>Bálint published <a href="http://doi.org/10.1126/scisignal.aal3606">a paper</a> in 2018, using dSTORM microscopy to resolve the nanoclustering of a receptor called natural killer group 2D (NKG2D). One of the challenges using the STROM microscope is to translate thousands, or sometimes millions, of stochastic fluorescent events into meaningful measurements. In this case, they wanted to know the size of nanoclusters and the interactions between them. To achieve that, they extracted the Euclid coordinates, which require:</p>
<ol>
<li>performing spatial analysis ($\hat{K}(t)$, $\hat{L}(t)$, and $\hat{H}(t)$)</li>
<li>generating a density map based on $\hat{H}(t)$,</li>
<li>thresholding density maps into binary maps</li>
</ol>
<figure>
    <img src="/posts/point_pattern_analysis/img_03.png" width="800"/> 
</figure>

<p>Be aware that under CSR, the $\hat{H}(t)$ value should be 0 (It is $\hat{L}(t) - t$), so $\hat{H}(t)$ reduced when the radius increased.</p>
<h2 id="implementation">Implementation</h2>
<p>Some software comes with the function of spatial analysis based on Ripley&rsquo;s K method. I wrote my own Python code for proof of concept, but found that the easiest way to implement is probably using a R package called <a href="https://cran.r-project.org/web/packages/spatstat/index.html">Spatstat</a>. I will write another post for demonstration.</p>
<hr>
<h2 id="reference">Reference</h2>
<ul>
<li>
<p>Williamson, D. J., Owen, D. M., Rossy, J., Magenau, A., Wehrmann, M., Gooding, J. J., &amp; Gaus, K. (2011). Pre-existing clusters of the adaptor Lat do not participate in early T cell signaling events. <em>Nature Immunology</em>, <em>12</em>(7), 655–662. <a href="http://doi.org/10.1038/ni.2049">http://doi.org/10.1038/ni.2049</a></p>
</li>
<li>
<p>Bálint, Š., Lopes, F. B., &amp; Davis, D. M. (2018). A nanoscale reorganization of the IL-15 receptor is triggered by NKG2D in a ligand-dependent manner. <em>Science Signaling</em>, <em>11</em>(525), eaal3606. <a href="http://doi.org/10.1126/scisignal.aal3606">http://doi.org/10.1126/scisignal.aal3606</a></p>
</li>
<li>
<p>Ripley, B. D. (1977). Modelling spatial patterns (with discussion). JR Statist. Soc. B, 39, 172-212.(1981) Spatial Statistics.</p>
</li>
<li>
<p>Getis, A. (1984). Interaction Modeling Using Second-Order Analysis. Environment and Planning A, 16(2), 173–183. <a href="http://doi.org/10.1068/a160173">http://doi.org/10.1068/a160173</a></p>
</li>
<li>
<p>Getis, A., Franklin, J. (1987) Second-Order Neighborhood Analysis of Mapped Point Patterns. Ecology 68:473-477. Reprinted with permission of The Ecological Society of America, Washington DC
<a href="papers3://publication/doi/10.1007/978-3-642-01976-0_7">Link to my paper3 database</a></p>
</li>
<li>
<p>Getis, A., &amp; Franklin, J. (2008). Second-Order Neighborhood Analysis of Mapped Point Patterns. In <em>Perspectives on Spatial Data Analysis</em> (pp. 93–100). Berlin, Heidelberg: Springer Berlin Heidelberg. <a href="http://doi.org/10.1007/978-3-642-01976-0_7">http://doi.org/10.1007/978-3-642-01976-0_7</a></p>
</li>
</ul>
<h2 id="book--other-resource">Book &amp; Other Resource</h2>
<p>Books for Spatial statistics</p>
<ul>
<li><a href="https://gis.stackexchange.com/questions/48754/learning-spatial-statistics">references - Learning Spatial Statistics? - Geographic Information Systems Stack Exchange</a></li>
<li>R code: <a href="http://rstudio-pubs-static.s3.amazonaws.com/5292_2b2fae3795a144b2a4b486fd2fc6fc57.html">Point Patterns: Hypothesis Testing</a></li>
<li>MATLAB tool:  <a href="https://github.com/quokka79/ClusterFields">GitHub - quokka79/ClusterFields: Getis &amp; Franklin Local Point Pattern Analysis for Localisation Microscopy Images</a></li>
</ul>

            </div>
        </article>

        <hr />

        <div class="post-info">

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>861 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2019-04-20 14:44 -0500</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="/posts/ktest_demo_01_simulator/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Ripley&#39;s K Demo: 01 Point Process Simulation</span>
                            </a>
                        </span>
                    

                    
                </div>
            </div>
        
            <div id="comments" class="thin">
                <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "mikecshih" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-163877741-1', 'auto');
        ga('send', 'pageview');
    </script>



    </body>
</html>
